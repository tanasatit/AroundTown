generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        Int      @id @default(autoincrement())
  name      String   @db.VarChar(100)
  email     String   @unique @db.VarChar(255)
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  collections Collection[]
  refills     Refill[]

  @@map("users")
}

model Collection {
  id             Int      @id @default(autoincrement())
  collectionDate DateTime @db.Date
  roundNumber    Int
  weekNumber     Int
  
  machineLocation String  @db.VarChar(200)
  
  machineCoins10baht Int
  
  exchangeCoins1baht   Int @default(0)
  exchangeCoins2baht   Int @default(0)
  exchangeCoins5baht   Int @default(0)
  exchangeCoins10baht  Int @default(0)
  exchangeNote20baht   Int @default(0)
  exchangeNote50baht   Int @default(0)
  exchangeNote100baht  Int @default(0)
  exchangeNote500baht  Int @default(0)
  exchangeNote1000baht Int @default(0)
  
  postcardsRemaining Int
  costPerPostcard    Decimal @default(13.766) @db.Decimal(10, 4)
  
  notes     String?  @db.Text
  createdBy Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [createdBy], references: [id])

  @@unique([collectionDate, roundNumber, machineLocation])
  @@index([collectionDate])
  @@index([weekNumber])
  @@index([machineLocation])
  @@map("collections")
}

model Refill {
  id              Int      @id @default(autoincrement())
  refillDate      DateTime @db.Date
  machineLocation String   @db.VarChar(200)
  postcardsAdded  Int
  postcardsBefore Int
  postcardsAfter  Int
  notes           String?  @db.Text
  createdBy       Int
  createdAt       DateTime @default(now())

  user User @relation(fields: [createdBy], references: [id])

  @@index([refillDate])
  @@index([machineLocation])
  @@map("refills")
}
